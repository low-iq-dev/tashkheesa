<%
  const baseTitle = (typeof title !== 'undefined' && title) ? String(title) : 'Tashkheesa';
  const pageTitle = baseTitle.includes('Tashkheesa') ? baseTitle : `${baseTitle} â€“ Tashkheesa`;
  const pageLang = (typeof lang !== 'undefined' && lang)
    ? lang
    : ((typeof locals !== 'undefined' && locals && locals.lang)
        ? locals.lang
        : ((typeof locals !== 'undefined' && locals && locals.user && locals.user.lang)
            ? locals.user.lang
            : 'en'));
  const pageDir = (String(pageLang).toLowerCase() === 'ar') ? 'rtl' : 'ltr';
  const layoutVariant = (typeof layout !== 'undefined' && layout) ? layout : 'public';
  const renderNav = (typeof showNav === 'undefined') ? true : Boolean(showNav);
%>
<!DOCTYPE html>
<html lang="<%= pageLang %>" dir="<%= pageDir %>">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title><%= pageTitle %></title>
  <link rel="stylesheet" href="/styles.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Source+Sans+3:wght@300;400;500;600;700&family=Source+Serif+4:wght@600;700&family=Noto+Sans+Arabic:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <link rel="icon" href="/favicon.ico" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32.png" />
  <link rel="icon" type="image/png" sizes="192x192" href="/favicon-192.png" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="manifest" href="/site.webmanifest" />
</head>
<body class="layout layout-<%= layoutVariant %>">
  <a class="skip-link" href="#main-content">Skip to content</a>
  <div class="layout-shell">
    <% if (renderNav) { %>
      <header class="site-header">
        <div class="container nav-container">
          <a href="/" class="nav-logo">
            <span class="logo-mark">T</span>
            <span class="logo-text">Tashkheesa</span>
          </a>
          <nav class="nav-links" aria-label="Primary">
            <a href="/services">Services</a>
            <a href="/privacy">Privacy</a>
            <a href="/terms">Terms</a>
          </nav>
          <div class="nav-actions">
            <a href="/order/start" class="btn btn-primary">Start Order</a>
            <a href="/login" class="btn btn-secondary">Portal</a>
          </div>
        </div>
      </header>
    <% } %>
    <div id="main-content" class="app-content" tabindex="-1">
