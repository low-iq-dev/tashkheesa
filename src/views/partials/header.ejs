<%
  const baseTitle = (typeof title !== 'undefined' && title) ? String(title) : 'Tashkheesa';
  const pageTitle = baseTitle.includes('Tashkheesa') ? baseTitle : `${baseTitle} â€“ Tashkheesa`;
  const pageLang = (typeof lang !== 'undefined' && lang)
    ? lang
    : ((typeof locals !== 'undefined' && locals && locals.lang)
        ? locals.lang
        : ((typeof locals !== 'undefined' && locals && locals.user && locals.user.lang)
            ? locals.user.lang
            : 'en'));
  const pageDir = (String(pageLang).toLowerCase() === 'ar') ? 'rtl' : 'ltr';
  const layoutVariant = (typeof layout !== 'undefined' && layout) ? layout : 'public';
  const renderNav = (typeof showNav === 'undefined') ? true : Boolean(showNav);
%>
<!DOCTYPE html>
<html lang="<%= pageLang %>" dir="<%= pageDir %>">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title><%= pageTitle %></title>
  <link rel="stylesheet" href="/styles.css" />
  <link rel="icon" href="/favicon.ico" />
</head>
<body class="layout layout-<%= layoutVariant %>">
  <a class="skip-link" href="#main-content">Skip to content</a>

  <% if (renderNav) { %>
  <header class="site-header">
    <div class="header-inner">
      <a href="/" class="site-brand">
        <div class="logo-wrap">
          <span class="brand-logo">T</span>
        </div>
        <span class="brand-text">Tashkheesa</span>
      </a>

      <nav class="main-nav">
        <ul class="nav-list">
          <li><a href="/services.html" class="nav-link">Services</a></li>
          <li><a href="/doctors.html" class="nav-link">Doctors</a></li>

          <li class="nav-dropdown">
            <span class="nav-link nav-dropdown-toggle">Portal</span>
            <ul class="nav-dropdown-menu">
              <li><a href="/login" class="nav-link">Patient</a></li>
              <li><a href="/portal/doctor" class="nav-link">Doctor</a></li>
              <li><a href="/portal/admin" class="nav-link">Admin</a></li>
              <li><a href="/portal/superadmin" class="nav-link">Superadmin</a></li>
            </ul>
          </li>
        </ul>
      </nav>

      <div class="nav-cta">
        <a href="/order/start" class="nav-link nav-cta-btn">Start Order</a>
      </div>
    </div>
  </header>
  <% } %>

  <main id="main-content" class="app-shell">
