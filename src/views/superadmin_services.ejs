<%- include('partials/header', { title: "Services", layout: "portal", showNav: true, showFooter: false, portalFrame: true, portalRole: 'superadmin', portalActive: 'services', portalNext: '/superadmin/services' }) %>
<%
  const isAr = (typeof lang !== 'undefined' && lang === 'ar');
%>
      <div class="admin-page">
        <div class="admin-page-header">
          <div class="admin-page-header-left">
            <nav class="admin-breadcrumb">
              <a href="/superadmin">Dashboard</a>
              <span class="admin-breadcrumb-sep">&rsaquo;</span>
              <span><%= isAr ? 'Ø§Ù„Ø®Ø¯Ù…Ø§Øª' : 'Services' %></span>
            </nav>
            <h1 class="admin-page-title"><%= isAr ? 'Ø§Ù„Ø®Ø¯Ù…Ø§Øª' : 'Services' %></h1>
            <p class="admin-page-subtitle"><%= isAr ? 'Ø¥Ø¯Ø§Ø±Ø© ÙƒØªØ§Ù„ÙˆØ¬ Ø§Ù„Ø®Ø¯Ù…Ø§Øª.' : 'Manage service catalog.' %></p>
          </div>
          <div class="admin-page-header-right">
            <a class="admin-btn admin-btn-primary" href="/superadmin/services/new">+ <%= isAr ? 'Ø®Ø¯Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø©' : 'New service' %></a>
          </div>
        </div>

        <div style="display:flex;align-items:center;gap:8px;margin-bottom:16px;padding:12px 16px;background:#f0f9ff;border-radius:10px;border:1px solid #bae6fd;">
          <span style="font-size:0.85rem;">ðŸ’°</span>
          <span style="font-size:0.8rem;color:#0369a1;">To manage regional pricing for all currencies, go to <a href="/admin/pricing" style="font-weight:600;color:#0369a1;">Pricing &rarr;</a></span>
        </div>

        <section class="admin-card">
          <div class="admin-card-body">
            <div class="table-responsive dashboard-scroll dashboard-scroll--services">
              <table>
                <thead>
                <tr>
                  <th>Code</th>
                  <th>Name</th>
                  <th>Specialty</th>
                  <th>Visibility</th>
                  <th></th>
                </tr>
              </thead>
              <tbody>
                <% (services || []).forEach(function(sv){ %>
                  <tr>
                    <td><%= sv.code || 'â€”' %></td>
                    <td><%= sv.name %></td>
                    <td><%= sv.specialty_name || 'â€”' %></td>
                    <td>
                      <% const isVisible = (sv.is_visible == null ? 1 : Number(sv.is_visible)) === 1; %>
                      <span class="status-pill <%= isVisible ? 'status-pill--completed' : 'status-pill--breached' %>">
                        <%= isVisible ? 'Visible' : 'Hidden' %>
                      </span>
                    </td>
                    <td style="white-space:nowrap; display:flex; gap:10px; justify-content:flex-end; align-items:center;">
                      <a class="admin-btn admin-btn-outline btn-small" href="/superadmin/services/<%= sv.id %>/edit">Edit</a>
                      <form method="post" action="/superadmin/services/<%= sv.id %>/toggle-visibility" style="margin:0;">
                        <%- (typeof csrfField === 'function') ? csrfField() : '' %>
                        <button type="submit" class="admin-btn admin-btn-outline btn-small"><%= isVisible ? 'Hide' : 'Unhide' %></button>
                      </form>
                    </td>
                  </tr>
                <% }); %>
                <% if (!services || !services.length) { %>
                  <tr><td colspan="5" class="empty">No services defined.</td></tr>
                <% } %>
              </tbody>
              </table>
            </div>
          </div>
        </section>
      </div>

<%- include('partials/footer', { showFooter: false, portalFrame: true }) %>
