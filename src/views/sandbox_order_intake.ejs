<%- include('partials/header', { title: "Sandbox Order Intake", layout: "portal", showNav: false }) %>
<% const brandSafe = (typeof brand !== 'undefined' && brand) ? brand : 'Tashkheesa'; %>
  <div class="portal-shell">
    <div class="portal-header">
      <div class="portal-logo">
        <%= brandSafe %>
        <span>Patient Portal</span>
      </div>
    </div>

    <div class="portal-grid">
      <aside class="portal-sidebar">
        <ul class="portal-nav">
          <li><a href="/dashboard">Dashboard</a></li>
          <li><a href="/portal/patient/orders/new">New Case</a></li>
          <li><a href="/portal/patient/alerts">Alerts</a></li>
          <li><a href="/patient/profile">Profile</a></li>
          <li><a href="/logout">Logout</a></li>
        </ul>
      </aside>

      <main class="portal-content">
        <div class="portal-hero">
          <h1 class="portal-hero-title">Sandbox Order Intake</h1>
        </div>

        <form method="post" action="/sandbox/order-intake" class="flow-card">
          <%- (typeof csrfField === 'function') ? csrfField() : '' %>
          <div class="form-group">
            <label class="form-label">API Key</label>
            <input type="text" name="api_key" required class="form-control" />
          </div>
          <div class="form-group">
            <label class="form-label">Patient name</label>
            <input type="text" name="patient_name" class="form-control" />
          </div>
          <div class="form-group">
            <label class="form-label">Patient email</label>
            <input type="email" name="patient_email" required class="form-control" />
          </div>
          <div class="form-group">
            <label class="form-label">Patient phone</label>
            <input type="text" name="patient_phone" class="form-control" />
          </div>
          <div class="form-group">
            <label class="form-label">Preferred language</label>
            <select name="preferred_lang" class="form-control">
              <option value="en">en</option>
              <option value="ar">ar</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">Specialty code</label>
            <input type="text" name="specialty_code" class="form-control" />
          </div>
          <div class="form-group">
            <label class="form-label">Service code</label>
            <input type="text" name="service_code" required class="form-control" />
          </div>
          <div class="form-group">
            <label class="form-label">SLA type</label>
            <select name="sla_type" required class="form-control">
              <option value="vip">vip (24h)</option>
              <option value="standard">standard (72h)</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">Notes</label>
            <textarea name="notes" class="form-control"></textarea>
          </div>
          <div class="form-group">
            <label class="form-label">File URLs (one per line)</label>
            <textarea name="file_urls" class="form-control"></textarea>
          </div>
          <div class="section-cta">
            <button type="submit" class="btn btn-primary">Submit</button>
          </div>
        </form>

        <% if (error) { %>
          <div class="flow-card">
            <div>Error: <%= error %></div>
          </div>
        <% } %>
        <% if (result) { %>
          <div class="flow-card">
            <div>Success! Order ID: <%= result.order_id %></div>
          </div>
        <% } %>
      </main>
    </div>
  </div>

<%- include('partials/footer', { showFooter: false }) %>
