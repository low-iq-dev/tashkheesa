<%- include('partials/header', { title: "Service Details", layout: "portal", showNav: false, portalFrame: true, portalRole: (typeof portalRole !== 'undefined' ? portalRole : 'superadmin'), portalActive: 'services' }) %>
      <div class="admin-page">
          <div class="admin-page-header">
            <div class="admin-page-header-left">
              <nav class="admin-breadcrumb">
                <a href="/admin">Dashboard</a>
                <span class="admin-breadcrumb-sep">›</span>
                <a href="/admin/services">Services</a>
                <span class="admin-breadcrumb-sep">›</span>
                <span><%= service && service.id ? service.name : 'Add Service' %></span>
              </nav>
              <h1 class="admin-page-title"><%= service && service.id ? 'Edit service' : 'New service' %></h1>
              <p class="admin-page-subtitle">Service catalog entry.</p>
            </div>
            <div class="admin-page-header-right">
              <a class="admin-btn admin-btn-outline" href="/admin/services">&larr; Back</a>
            </div>
          </div>

          <% if (error) { %>
            <div class="error"><%= error %></div>
          <% } %>

          <div class="admin-card">
            <div class="admin-card-body">
              <form method="post" action="<%= service && service.id ? '/admin/services/' + service.id + '/edit' : '/admin/services/new' %>">
                <%- (typeof csrfField === 'function') ? csrfField() : '' %>
                <div class="admin-form-grid">
                  <div class="admin-form-group">
                    <label>Specialty *</label>
                    <select name="specialty_id" required>
                      <option value="">— Select —</option>
                      <% (specialties || []).forEach(function(sp){ %>
                        <option value="<%= sp.id %>" <%= service && service.specialty_id === sp.id ? 'selected' : '' %>><%= sp.name %></option>
                      <% }) %>
                    </select>
                  </div>
                  <div class="admin-form-group">
                    <label>Code</label>
                    <input type="text" name="code" value="<%= service && service.code ? service.code : '' %>" />
                  </div>
                  <div class="admin-form-group">
                    <label>Name *</label>
                    <input type="text" name="name" required value="<%= service && service.name ? service.name : '' %>" />
                  </div>
                  <div class="admin-form-group">
                    <label>Base price</label>
                    <input type="number" step="0.01" name="base_price" value="<%= service && service.base_price != null ? service.base_price : '' %>" />
                  </div>
                  <div class="admin-form-group">
                    <label>Doctor fee</label>
                    <input type="number" step="0.01" name="doctor_fee" value="<%= service && service.doctor_fee != null ? service.doctor_fee : '' %>" />
                  </div>
                  <div class="admin-form-group">
                    <label>Currency</label>
                    <input type="text" name="currency" value="<%= service && service.currency ? service.currency : 'EGP' %>" />
                  </div>
                  <div class="admin-form-group" style="grid-column:1/-1;">
                    <label>Payment link</label>
                    <input type="text" name="payment_link" value="<%= service && service.payment_link ? service.payment_link : '' %>" />
                  </div>
                  <div class="admin-form-group" style="grid-column:1/-1;text-align:right;">
                    <button type="submit" class="admin-btn admin-btn-primary">Save</button>
                  </div>
                </div>
              </form>
            </div>
          </div>
      </div>

<%- include('partials/footer', { showFooter: false, portalFrame: true }) %>