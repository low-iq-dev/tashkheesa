<!DOCTYPE html>
<html lang="<%= (typeof lang !== 'undefined' && lang) ? lang : 'en' %>" dir="<%= (typeof dir !== 'undefined' && dir) ? dir : (((typeof lang !== 'undefined' && lang) === 'ar') ? 'rtl' : 'ltr') %>">
<head>
  <meta charset="utf-8" />
  <title><%= (typeof isAr !== 'undefined' && isAr) ? 'إعادة تعيين كلمة المرور – تشخيصة' : 'Reset password – Tashkheesa' %></title>
  <link rel="stylesheet" href="/styles.css" />
</head>
<body class="auth-shell">
  <div class="page-shell" style="display:flex; justify-content:center; width:100%;">
    <div class="auth-card">
      <div class="auth-header">
        <div class="brand" style="display:flex; align-items:center; justify-content:space-between; gap:16px;">
          <div style="display:flex; align-items:center; gap:12px;">
            <div class="brand-logo">T</div>
            <div>
              <div class="brand-text-main">Tashkheesa</div>
              <div class="brand-text-sub"><%= (typeof isAr !== 'undefined' && isAr) ? 'إعادة تعيين كلمة المرور' : 'Reset password' %></div>
            </div>
          </div>

          <div class="lang-switch" style="font-weight:600; opacity:.9;">
            <a href="/lang/en?next=/reset-password/<%= token %>">EN</a> | <a href="/lang/ar?next=/reset-password/<%= token %>">AR</a>
          </div>
        </div>
      </div>

    <h2 class="auth-title"><%= (typeof isAr !== 'undefined' && isAr) ? 'إعادة تعيين كلمة المرور' : 'Reset your password' %></h2>

    <% if (error) { %>
      <div class="card" style="background:#fef2f2; border:1px solid #fecdd3; color:#991b1b; margin-bottom:12px;"><%= error %></div>
    <% } %>
    <% if (success) { %>
      <div class="card" style="background:#ecfdf3; border:1px solid #bbf7d0; color:#166534; margin-bottom:12px;"><%= success %></div>
    <% } %>

    <form method="post" action="/reset-password/<%= token %>">
      <%- (typeof csrfField === 'function') ? csrfField() : '' %>
      <input type="hidden" name="token" value="<%= token %>" />
      <label class="input-label"><%= (typeof isAr !== 'undefined' && isAr) ? 'كلمة مرور جديدة' : 'New password' %></label>
      <input class="input-field" type="password" name="password" required minlength="8" />

      <label class="input-label"><%= (typeof isAr !== 'undefined' && isAr) ? 'تأكيد كلمة المرور' : 'Confirm password' %></label>
      <input class="input-field" type="password" name="confirm_password" required minlength="8" />

      <div class="actions" style="margin-top:12px;">
        <button class="btn btn-primary" type="submit"><%= (typeof isAr !== 'undefined' && isAr) ? 'تحديث كلمة المرور' : 'Update password' %></button>
      </div>
    </form>
    <div class="footer" style="margin-top:12px; font-size:12px; color: var(--text-muted); text-align:center;">
      <a class="link-muted" href="/login"><%= (typeof isAr !== 'undefined' && isAr) ? 'العودة لتسجيل الدخول' : 'Back to login' %></a>
    </div>
  </div>
</div>
</body>
</html>
