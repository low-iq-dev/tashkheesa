<%
  var _isAr = (typeof isAr !== 'undefined') ? isAr : false;
  var _doctor = (typeof doctor !== 'undefined') ? doctor : (typeof user !== 'undefined' ? user : {});
  var _specialty = (typeof specialty !== 'undefined' && specialty) ? specialty : null;
  var _specialties = (typeof specialties !== 'undefined' && Array.isArray(specialties)) ? specialties : [];
  var _success = (typeof success !== 'undefined') ? success : null;
  var _error = (typeof error !== 'undefined') ? error : null;
%>

<div class="portal-hero" style="margin-bottom:var(--space-2, 16px);">
  <h1 class="portal-hero-title"><%= _isAr ? 'الملف الشخصي' : 'My Profile' %></h1>
  <p class="portal-hero-subtitle"><%= _isAr ? 'إدارة معلوماتك الشخصية والمهنية' : 'Manage your personal and professional information' %></p>
</div>

<% if (_success) { %>
<div class="alert alert-success" style="background:#d1fae5;color:#065f46;padding:12px 16px;border-radius:8px;margin-bottom:16px;"><%= _success %></div>
<% } %>
<% if (_error) { %>
<div class="alert alert-error" style="background:#fee2e2;color:#991b1b;padding:12px 16px;border-radius:8px;margin-bottom:16px;"><%= _error %></div>
<% } %>

<div style="max-width:640px;">
  <form method="POST" action="/portal/doctor/profile" style="display:flex;flex-direction:column;gap:16px;">

    <div class="form-group">
      <label for="name" style="font-weight:600;margin-bottom:4px;display:block;"><%= _isAr ? 'الاسم' : 'Full Name' %></label>
      <input type="text" id="name" name="name" value="<%= _doctor.name || '' %>" class="form-input" style="width:100%;padding:10px 14px;border:1px solid #d1d5db;border-radius:8px;font-size:1rem;" required />
    </div>

    <div class="form-group">
      <label for="email" style="font-weight:600;margin-bottom:4px;display:block;"><%= _isAr ? 'البريد الإلكتروني' : 'Email' %></label>
      <input type="email" id="email" value="<%= _doctor.email || '' %>" class="form-input" style="width:100%;padding:10px 14px;border:1px solid #d1d5db;border-radius:8px;font-size:1rem;background:#f3f4f6;color:#6b7280;" disabled />
      <small style="color:#6b7280;"><%= _isAr ? 'لا يمكن تغيير البريد الإلكتروني' : 'Email cannot be changed' %></small>
    </div>

    <div class="form-group">
      <label for="phone" style="font-weight:600;margin-bottom:4px;display:block;"><%= _isAr ? 'رقم الهاتف' : 'Phone' %></label>
      <input type="tel" id="phone" name="phone" value="<%= _doctor.phone || '' %>" class="form-input" style="width:100%;padding:10px 14px;border:1px solid #d1d5db;border-radius:8px;font-size:1rem;" placeholder="+20 xxx xxx xxxx" />
    </div>

    <div class="form-group">
      <label for="specialty_id" style="font-weight:600;margin-bottom:4px;display:block;"><%= _isAr ? 'التخصص' : 'Specialty' %></label>
      <select id="specialty_id" name="specialty_id" class="form-input" style="width:100%;padding:10px 14px;border:1px solid #d1d5db;border-radius:8px;font-size:1rem;">
        <option value=""><%= _isAr ? 'اختر التخصص' : 'Select specialty' %></option>
        <% _specialties.forEach(function(s) { %>
          <option value="<%= s.id %>" <%= (_doctor.specialty_id === s.id) ? 'selected' : '' %>><%= s.name %></option>
        <% }); %>
      </select>
    </div>

    <div class="form-group">
      <label for="bio" style="font-weight:600;margin-bottom:4px;display:block;"><%= _isAr ? 'نبذة مختصرة' : 'Bio' %></label>
      <textarea id="bio" name="bio" rows="4" class="form-input" style="width:100%;padding:10px 14px;border:1px solid #d1d5db;border-radius:8px;font-size:1rem;resize:vertical;" placeholder="<%= _isAr ? 'اكتب نبذة مختصرة عن خبراتك...' : 'Write a brief bio about your experience...' %>"><%= _doctor.bio || '' %></textarea>
    </div>

    <button type="submit" class="btn btn-primary" style="align-self:flex-start;padding:12px 32px;background:var(--deep-blue,#1a365d);color:#fff;border:none;border-radius:8px;font-size:1rem;font-weight:600;cursor:pointer;">
      <%= _isAr ? 'حفظ التغييرات' : 'Save Changes' %>
    </button>
  </form>
</div>
